#N canvas 167 226 739 571 10;
#X declare -path ./komport -path ./moocow -path ./list-abs -path ./lib
;
#N canvas 859 23 450 300 settings 0;
#X msg 140 89 close;
#X msg 77 68 help;
#X msg 56 47 info;
#X msg 182 131 devices;
#X msg 203 152 ports;
#X msg 161 110 open 2;
#X obj 102 250 outlet;
#X obj 138 28 select 0 1;
#X obj 137 0 inlet;
#X msg 294 180 verbose 1;
#X obj 294 147 r lb1;
#X obj 290 33 s bufread-reset;
#X obj 166 51 t b b b;
#X obj 239 100 s read-metro-on;
#X obj 252 121 s read-metro-off;
#X connect 0 0 6 0;
#X connect 1 0 6 0;
#X connect 2 0 6 0;
#X connect 3 0 6 0;
#X connect 4 0 6 0;
#X connect 5 0 6 0;
#X connect 7 0 0 0;
#X connect 7 0 14 0;
#X connect 7 1 12 0;
#X connect 8 0 7 0;
#X connect 9 0 6 0;
#X connect 10 0 9 0;
#X connect 12 0 5 0;
#X connect 12 1 13 0;
#X connect 12 2 11 0;
#X restore 106 205 pd settings;
#N canvas 0 22 464 331 init 0;
#X obj 65 30 loadbang;
#X obj 65 52 t b b b b;
#X obj 65 184 s lb4;
#X obj 85 154 s lb3;
#X obj 105 124 s lb2;
#X obj 125 94 s lb1;
#X obj 68 240 declare -path ./komport -path ./moocow -path ./list-abs
-path ./lib;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 3 0;
#X connect 1 2 4 0;
#X connect 1 3 5 0;
#X restore 56 32 pd init;
#N canvas 433 87 879 727 parse-output 0;
#X obj 41 180 select 10 13 92;
#X text 285 441 escape : 92 \; delimiter : 10 \; cr : 13 \;;
#X obj 41 30 inlet;
#X obj 581 241 t l;
#X obj 481 241 list prepend;
#X obj 550 211 r clear-list;
#X obj 437 175 r output-list;
#X obj 18 493 t b b;
#X obj 18 565 s clear-list;
#X obj 50 537 s output-list;
#X obj 507 567 print ADDRESS;
#X obj 497 505 print CONFIG;
#X obj 587 415 print LED;
#X obj 235 396 value escape-flag;
#X msg 235 371 1;
#X obj 295 126 value escape-flag;
#X obj 258 159 t b f;
#X obj 258 220 value escape-flag;
#X msg 258 181 0;
#X obj 18 314 t b b;
#X obj 122 409 value escape-flag;
#X msg 204 494 10;
#X obj 122 434 select 0 1;
#X msg 122 466 1;
#X obj 18 404 spigot;
#X text 167 539 If not escaped \, treat as delimiter \; If escaped
\, do not treat as delimiter \, add byte to list \, and clear escape
flag \;, f 29;
#X obj 164 472 t b b;
#X msg 164 494 0;
#X obj 164 516 value escape-flag;
#X obj 295 76 r lb1;
#X msg 295 98 0;
#X obj 50 257 value escape-flag;
#X obj 50 282 select 0 1;
#X obj 92 320 t b b;
#X msg 92 342 0;
#X obj 92 364 value escape-flag;
#X msg 132 342 13;
#N canvas 248 83 820 685 plot-parsed-MMG 0;
#X obj 77 20 inlet;
#X obj 79 89 list split 2;
#X obj 129 195 list split 2;
#X obj 182 230 list split 1;
#X obj 285 77 list length;
#X floatatom 285 99 5 0 0 0 - - -, f 5;
#X obj 459 371 list split 1;
#X obj 545 457 list split 1;
#X obj 686 435 list length;
#X floatatom 686 457 5 0 0 0 - - -, f 5;
#N canvas 1675 133 814 613 MMG-DATA 0;
#X obj 34 7 inlet;
#X floatatom 489 96 5 0 0 0 - - -, f 5;
#X obj 489 115 * 64;
#X obj 29 84 t b l b b b;
#X obj 55 263 s mmg-signal;
#N canvas 1954 90 1119 832 unpack-bytes 0;
#X obj 53 34 inlet;
#X obj 95 651 outlet;
#X text 289 13 Here \, we unpack the 80 bytes into 64 samples. Every
data load in an MMG packet contains 80 bytes. The bytes are grouped
into 16 packages of 5 bytes each. There are 4 10-bit samples in every
package of 5 bytes. With 16 packages of 5 bytes (4 samples) \, that
makes 64 samples.;
#X obj 89 152 list split 5;
#X obj 63 223 bytes2samples;
#X obj 59 267 list append;
#X obj 199 156 list split 5;
#X obj 173 249 list append;
#X obj 310 159 list split 5;
#X obj 284 252 list append;
#X obj 420 163 list split 5;
#X obj 394 256 list append;
#X obj 515 164 list split 5;
#X obj 489 257 list append;
#X obj 625 168 list split 5;
#X obj 599 261 list append;
#X obj 736 171 list split 5;
#X obj 710 264 list append;
#X obj 829 173 list split 5;
#X obj 803 266 list append;
#X obj 169 303 list split 5;
#X obj 143 396 list append;
#X obj 279 307 list split 5;
#X obj 253 400 list append;
#X obj 390 310 list split 5;
#X obj 364 403 list append;
#X obj 500 314 list split 5;
#X obj 474 407 list append;
#X obj 595 315 list split 5;
#X obj 569 408 list append;
#X obj 705 319 list split 5;
#X obj 679 412 list append;
#X obj 816 322 list split 5;
#X obj 790 415 list append;
#X text 138 119 Take 16 packages of 5 bytes \, and unpack each into
4 samples. Pack the result back into a single 64-element list;
#N canvas 0 22 450 300 reference-output 0;
#X text 115 46 0 0 4 0 0 0 0 0 0 0 0 0 \; \; 1 1 4 2 0 0 64 16 0 1
0 0 \; \; 2 2 4 4 0 0 128 24 0 1 2 0 \; \; 3 3 4 6 0 0 192 27 0 1 2
3 \; \; 4 5 9 0 1 1 0 0 0 0 0 0 \; \; 5 6 9 2 1 1 64 16 0 1 0 0 \;
\; 6 7 9 4 1 1 128 24 0 1 2 0 \; \; 7 8 9 6 1 1 192 27 0 1 2 3 \; \;
;
#X restore 798 18 pd reference-output;
#X obj 173 227 bytes2samples;
#X obj 284 230 bytes2samples;
#X obj 394 234 bytes2samples;
#X obj 489 235 bytes2samples;
#X obj 599 239 bytes2samples;
#X obj 710 242 bytes2samples;
#X obj 803 244 bytes2samples;
#X obj 143 374 bytes2samples;
#X obj 253 378 bytes2samples;
#X obj 364 381 bytes2samples;
#X obj 474 385 bytes2samples;
#X obj 569 386 bytes2samples;
#X obj 679 390 bytes2samples;
#X obj 790 393 bytes2samples;
#X obj 900 397 bytes2samples;
#N canvas 0 22 450 278 (subpatch) 0;
#X array showpacket 64 float 0;
#X coords 0 1023 63 0 200 140 1 0 0;
#X restore 563 475 graph;
#X obj 363 523 list prepend 0;
#X obj 363 545 s showpacket;
#X text 375 671 Marije: Basically I am sending a (ringbuffer) block
of 64 samples or so \; with an index of the last sample of the previous
block and the current index (so you know between which indices in the
block new data is).;
#X obj 65 539 list-rot;
#X obj 127 509 + 1;
#X obj 127 487 r mmg-block-prev-point;
#X text 100 438 Assuming that the previous index is the last sample
of the previous block \, so we want to start one past that \, and read
through to the current index \, wrapping around if needed;
#X connect 0 0 3 0;
#X connect 3 0 4 0;
#X connect 3 1 6 0;
#X connect 4 0 5 0;
#X connect 5 0 52 0;
#X connect 5 0 55 0;
#X connect 6 0 36 0;
#X connect 6 1 8 0;
#X connect 7 0 5 1;
#X connect 8 0 37 0;
#X connect 8 1 10 0;
#X connect 9 0 7 1;
#X connect 10 0 38 0;
#X connect 10 1 12 0;
#X connect 11 0 9 1;
#X connect 12 0 39 0;
#X connect 12 1 14 0;
#X connect 13 0 11 1;
#X connect 14 0 40 0;
#X connect 14 1 16 0;
#X connect 15 0 13 1;
#X connect 16 0 41 0;
#X connect 16 1 18 0;
#X connect 17 0 15 1;
#X connect 18 0 42 0;
#X connect 18 1 20 0;
#X connect 19 0 17 1;
#X connect 20 0 43 0;
#X connect 20 1 22 0;
#X connect 21 0 19 1;
#X connect 22 0 44 0;
#X connect 22 1 24 0;
#X connect 23 0 21 1;
#X connect 24 0 45 0;
#X connect 24 1 26 0;
#X connect 25 0 23 1;
#X connect 26 0 46 0;
#X connect 26 1 28 0;
#X connect 27 0 25 1;
#X connect 28 0 47 0;
#X connect 28 1 30 0;
#X connect 29 0 27 1;
#X connect 30 0 48 0;
#X connect 30 1 32 0;
#X connect 31 0 29 1;
#X connect 32 0 49 0;
#X connect 32 1 50 0;
#X connect 33 0 31 1;
#X connect 36 0 7 0;
#X connect 37 0 9 0;
#X connect 38 0 11 0;
#X connect 39 0 13 0;
#X connect 40 0 15 0;
#X connect 41 0 17 0;
#X connect 42 0 19 0;
#X connect 43 0 21 0;
#X connect 44 0 23 0;
#X connect 45 0 25 0;
#X connect 46 0 27 0;
#X connect 47 0 29 0;
#X connect 48 0 31 0;
#X connect 49 0 33 0;
#X connect 50 0 33 1;
#X connect 52 0 53 0;
#X connect 55 0 1 0;
#X connect 56 0 55 1;
#X connect 57 0 56 0;
#X restore 58 133 pd unpack-bytes;
#X obj 55 242 list prepend;
#X obj 356 475 tabletool mmg-scaled;
#X msg 271 381 copy mmg-signal;
#X msg 393 349 1;
#X obj 393 371 / 1023;
#X msg 393 393 scale \$1;
#X msg 478 410 scale 2;
#X msg 548 436 offset -1;
#X obj 57 562 soundfiler;
#X msg 489 138 \; mmg-signal resize \$1 \; mmg-scaled resize \$1 \;
;
#X obj 338 138 table mmg-scaled;
#X obj 125 167 r mmg-block-size;
#X obj 58 201 list split;
#X obj 147 253 +;
#X obj 175 254 f;
#X obj 173 198 r bufread-reset;
#X msg 173 220 0;
#X obj 629 33 r bufread-reset;
#X obj 489 47 loadbang;
#X msg 489 69 128;
#X obj 397 257 r export-file;
#X obj 397 279 t b b b b b;
#X obj 21 438 savepanel;
#X msg 629 59 \; mmg-signal const 512 \; mmg-scaled const 0 \;;
#X floatatom 155 294 5 0 0 0 - - -, f 5;
#X msg 120 522 write -wave -rate 2000 2000.wav mmg-scaled;
#X msg 78 492 write -wave -rate 500 500.wav mmg-scaled;
#X msg 21 462 write -wave -rate 500 \$1 mmg-scaled;
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 2 0 15 0;
#X connect 3 1 5 0;
#X connect 5 0 18 0;
#X connect 6 0 4 0;
#X connect 8 0 7 0;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 7 0;
#X connect 12 0 7 0;
#X connect 13 0 7 0;
#X connect 17 0 18 1;
#X connect 17 0 19 0;
#X connect 18 0 6 0;
#X connect 19 0 20 0;
#X connect 19 0 6 1;
#X connect 19 0 30 0;
#X connect 20 0 19 1;
#X connect 21 0 22 0;
#X connect 22 0 20 0;
#X connect 23 0 29 0;
#X connect 24 0 25 0;
#X connect 25 0 1 0;
#X connect 26 0 27 0;
#X connect 27 0 28 0;
#X connect 27 1 13 0;
#X connect 27 2 12 0;
#X connect 27 3 9 0;
#X connect 27 4 8 0;
#X connect 28 0 33 0;
#X connect 31 0 14 0;
#X connect 32 0 14 0;
#X connect 33 0 14 0;
#X restore 663 577 pd MMG-DATA;
#X obj 71 319 print MMG-ADDR;
#X obj 129 287 print MMG-LQI-RSSI;
#X obj 182 260 print MMG-ID;
#X obj 344 399 print MMG-BATT;
#X obj 292 431 print MMG-TIME;
#X obj 321 272 list split 2;
#X text 367 198 Taking out these two items \, which were in old sketches
\, but not part of the latest protocol.;
#X obj 652 535 list prepend;
#X floatatom 26 188 5 0 0 0 - - -, f 5;
#X obj 32 160 unpack f f;
#X floatatom 78 188 5 0 0 0 - - -, f 5;
#X floatatom 86 257 5 0 0 0 - - -, f 5;
#X obj 92 229 unpack f f;
#X floatatom 138 257 5 0 0 0 - - -, f 5;
#X floatatom 145 439 5 0 0 0 - - -, f 5;
#X obj 145 417 list length;
#X text 49 473 MMG pack seems to have 85 bytes \, rather than the 83
specified in the tech guide;
#X floatatom 216 327 5 0 0 0 - - -, f 5;
#X floatatom 280 370 5 0 0 0 - - -, f 5;
#X obj 286 342 unpack f f;
#X floatatom 332 370 5 0 0 0 - - -, f 5;
#N canvas 335 127 450 300 timing 0;
#X obj 26 80 t b b;
#X obj 26 102 timer;
#X floatatom 26 124 5 0 0 0 - - -, f 5;
#X obj 218 138 getmax 0;
#X floatatom 218 160 5 0 0 0 - - -, f 5;
#X floatatom 294 160 5 0 0 0 - - -, f 5;
#X obj 294 138 getmin 1000;
#X obj 396 123 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 25 16 inlet;
#X connect 0 0 1 0;
#X connect 0 1 1 1;
#X connect 1 0 2 0;
#X connect 1 0 3 0;
#X connect 1 0 6 0;
#X connect 3 0 4 0;
#X connect 6 0 5 0;
#X connect 7 0 6 1;
#X connect 7 0 3 1;
#X connect 8 0 0 0;
#X restore 250 18 pd timing;
#X obj 459 401 print MMG-PREV-IDX;
#X obj 552 538 print MMG-IDX;
#X obj 426 548 -;
#X obj 426 570 moses 0;
#X obj 412 598 + 64;
#X obj 425 464 t b b f;
#X obj 426 522 f;
#X obj 515 605 s mmg-block-current-point;
#X obj 433 642 s mmg-block-size;
#X obj 208 603 s mmg-block-prev-point;
#X connect 0 0 4 0;
#X connect 0 0 1 0;
#X connect 0 0 32 0;
#X connect 1 0 20 0;
#X connect 1 1 2 0;
#X connect 2 0 23 0;
#X connect 2 1 3 0;
#X connect 2 1 26 0;
#X connect 3 0 28 0;
#X connect 3 1 16 0;
#X connect 4 0 5 0;
#X connect 6 0 38 0;
#X connect 6 1 7 0;
#X connect 7 0 39 1;
#X connect 7 0 40 0;
#X connect 7 1 8 0;
#X connect 7 1 18 1;
#X connect 8 0 9 0;
#X connect 16 0 30 0;
#X connect 16 1 6 0;
#X connect 18 0 10 0;
#X connect 20 0 19 0;
#X connect 20 1 21 0;
#X connect 23 0 22 0;
#X connect 23 1 24 0;
#X connect 26 0 25 0;
#X connect 30 0 29 0;
#X connect 30 1 31 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 36 1 41 0;
#X connect 37 0 41 0;
#X connect 38 0 18 0;
#X connect 38 1 39 0;
#X connect 38 2 35 1;
#X connect 38 2 42 0;
#X connect 39 0 35 0;
#X restore 535 473 pd plot-parsed-MMG;
#X obj 242 259 value escape-flag;
#X obj 242 284 select 0 1;
#X obj 284 322 t b b;
#X msg 284 344 0;
#X obj 284 366 value escape-flag;
#X msg 324 344 92;
#X obj 437 277 list prepend;
#X obj 437 308 spigot;
#X obj 517 306 inlet;
#X text 692 489 Setup: S (83) \; Address: A (65) \; Config: C (67)
\; MMG: M (77) \; MPU: m (109) \; LED: L (76) \; battery: b (98) \;
;
#X obj 404 571 list split 5;
#X obj 440 611 print SERIAL;
#X text 397 638 Not sure what first 5 bytes of serial message are.
Doesn't seem to match tech document;
#X obj 437 343 route 83 65 67 77 109 76 98 108;
#X obj 691 381 print OTHER;
#X obj 661 411 print REPLY;
#X obj 462 536 list split 5;
#X obj 669 442 print BATTERY;
#N canvas 0 22 1288 403 unpack-MPU 0;
#X obj 87 32 inlet;
#X obj 107 114 list split 8;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 156 201 pd pack-16bits;
#X obj 151 145 list split 2;
#X obj 151 167 unpack f f;
#X text 227 100 MPU data is 3x3x2;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 255 205 pd pack-16bits;
#X obj 250 149 list split 2;
#X obj 250 171 unpack f f;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 352 203 pd pack-16bits;
#X obj 347 147 list split 2;
#X obj 347 169 unpack f f;
#X obj 156 222 s MPU-1-1;
#X obj 352 225 s MPU-1-3;
#X obj 255 227 s MPU-1-2;
#X text 36 57 Not sure what first 8 bytes are in the MPU message;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 546 201 pd pack-16bits;
#X obj 541 145 list split 2;
#X obj 541 167 unpack f f;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 645 205 pd pack-16bits;
#X obj 640 149 list split 2;
#X obj 640 171 unpack f f;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 742 203 pd pack-16bits;
#X obj 737 147 list split 2;
#X obj 737 169 unpack f f;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 936 201 pd pack-16bits;
#X obj 931 145 list split 2;
#X obj 931 167 unpack f f;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 1035 205 pd pack-16bits;
#X obj 1030 149 list split 2;
#X obj 1030 171 unpack f f;
#N canvas 214 105 602 361 pack-16bits 0;
#X obj 112 109 dec2bin, f 29;
#X obj 111 49 inlet;
#X obj 313 103 dec2bin, f 29;
#X obj 312 43 inlet;
#X obj 201 225 bin2dec-16, f 41;
#X obj 201 247 outlet;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 0 2 4 2;
#X connect 0 3 4 3;
#X connect 0 4 4 4;
#X connect 0 5 4 5;
#X connect 0 6 4 6;
#X connect 0 7 4 7;
#X connect 1 0 0 0;
#X connect 2 0 4 8;
#X connect 2 1 4 9;
#X connect 2 2 4 10;
#X connect 2 3 4 11;
#X connect 2 4 4 12;
#X connect 2 5 4 13;
#X connect 2 6 4 14;
#X connect 2 7 4 15;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X restore 1132 203 pd pack-16bits;
#X obj 1127 147 list split 2;
#X obj 1127 169 unpack f f;
#X obj 546 223 s MPU-2-1;
#X obj 645 227 s MPU-2-2;
#X obj 742 225 s MPU-2-3;
#X obj 936 222 s MPU-3-1;
#X obj 1035 227 s MPU-3-2;
#X obj 1132 225 s MPU-3-3;
#X text 93 277 Could be signed 16-bit numbers \, so should go from
-32768 to +32768;
#X floatatom 110 228 5 0 0 0 - - -, f 5;
#X connect 0 0 1 0;
#X connect 1 1 3 0;
#X connect 2 0 12 0;
#X connect 2 0 41 0;
#X connect 3 0 4 0;
#X connect 3 1 7 0;
#X connect 4 0 2 0;
#X connect 4 1 2 1;
#X connect 6 0 14 0;
#X connect 7 0 8 0;
#X connect 7 1 10 0;
#X connect 8 0 6 0;
#X connect 8 1 6 1;
#X connect 9 0 13 0;
#X connect 10 0 11 0;
#X connect 10 1 17 0;
#X connect 11 0 9 0;
#X connect 11 1 9 1;
#X connect 16 0 34 0;
#X connect 17 0 18 0;
#X connect 17 1 20 0;
#X connect 18 0 16 0;
#X connect 18 1 16 1;
#X connect 19 0 35 0;
#X connect 20 0 21 0;
#X connect 20 1 23 0;
#X connect 21 0 19 0;
#X connect 21 1 19 1;
#X connect 22 0 36 0;
#X connect 23 0 24 0;
#X connect 23 1 26 0;
#X connect 24 0 22 0;
#X connect 24 1 22 1;
#X connect 25 0 37 0;
#X connect 26 0 27 0;
#X connect 26 1 29 0;
#X connect 27 0 25 0;
#X connect 27 1 25 1;
#X connect 28 0 38 0;
#X connect 29 0 30 0;
#X connect 29 1 32 0;
#X connect 30 0 28 0;
#X connect 30 1 28 1;
#X connect 31 0 39 0;
#X connect 32 0 33 0;
#X connect 33 0 31 0;
#X connect 33 1 31 1;
#X restore 558 447 pd unpack-MPU;
#X connect 0 0 19 0;
#X connect 0 1 31 0;
#X connect 0 2 38 0;
#X connect 0 3 16 0;
#X connect 2 0 0 0;
#X connect 3 0 4 1;
#X connect 4 0 3 0;
#X connect 4 0 44 1;
#X connect 5 0 4 1;
#X connect 6 0 44 0;
#X connect 7 0 8 0;
#X connect 7 1 9 0;
#X connect 14 0 13 0;
#X connect 16 0 18 0;
#X connect 16 1 4 0;
#X connect 18 0 17 0;
#X connect 19 0 24 0;
#X connect 19 1 20 0;
#X connect 20 0 22 0;
#X connect 21 0 4 0;
#X connect 22 0 23 0;
#X connect 22 1 26 0;
#X connect 23 0 24 1;
#X connect 24 0 7 0;
#X connect 26 0 27 0;
#X connect 26 1 21 0;
#X connect 27 0 28 0;
#X connect 27 0 24 1;
#X connect 29 0 30 0;
#X connect 30 0 15 0;
#X connect 31 0 32 0;
#X connect 32 1 33 0;
#X connect 33 0 34 0;
#X connect 33 1 36 0;
#X connect 34 0 35 0;
#X connect 36 0 4 0;
#X connect 38 0 39 0;
#X connect 39 0 14 0;
#X connect 39 1 40 0;
#X connect 40 0 41 0;
#X connect 40 1 43 0;
#X connect 41 0 42 0;
#X connect 43 0 4 0;
#X connect 44 0 45 0;
#X connect 45 0 51 0;
#X connect 46 0 45 1;
#X connect 48 1 49 0;
#X connect 51 0 48 0;
#X connect 51 1 54 0;
#X connect 51 2 11 0;
#X connect 51 3 37 0;
#X connect 51 4 56 0;
#X connect 51 5 12 0;
#X connect 51 6 55 0;
#X connect 51 7 53 0;
#X connect 51 8 52 0;
#X connect 54 1 10 0;
#X restore 47 348 pd parse-output;
#N canvas 392 234 951 479 messages 0;
#X text 302 49 2.2.2 Adddress;
#X obj 330 356 s send-packet;
#X text 84 229 escape : 92 \; delimiter : 10 \; cr : 13 \;;
#X text 76 308 Setup: S (83) \; Address: A (65) \; Config: C (67) \;
MMG: M (77) \; MPU: m (109) \; LED: L (76) \;;
#X text 228 103 Send a serial number request;
#X msg 308 190 92 65 252 194 61 0 0 4 153 173 77 77 10;
#X msg 374 231 92 67 77 77 0 0 0 10;
#X text 306 137 Set the wireless address. Bytes 3-10 are the serial
number reported from the serial number request. Bytes 11-12 are the
address we're setting;
#X text 550 239 Configure the transmitter to send MMG \, MPU \, and
Temp sensor data;
#X msg 396 263 92 67 77 77 255 0 0 10;
#X msg 421 294 92 67 77 77 255 255 255 10;
#X msg 230 128 92 83 10;
#X connect 5 0 1 0;
#X connect 6 0 1 0;
#X connect 9 0 1 0;
#X connect 10 0 1 0;
#X connect 11 0 1 0;
#X restore 56 92 pd messages;
#X obj 47 150 r send-packet;
#X obj 106 185 tgl 15 0 empty empty Open/close 17 7 0 12 -262144 -1
-1 0 1;
#X obj 97 318 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#N canvas 175 28 731 562 other-info 0;
#X floatatom 140 338 10 0 0 1 baud - -, f 10;
#X floatatom 278 402 3 0 0 3 parity - -, f 3;
#X floatatom 318 402 3 0 0 2 stop - -, f 3;
#X floatatom 358 402 3 0 0 3 data - -, f 3;
#X floatatom 569 391 3 0 0 0 port - -, f 3;
#X obj 454 487 tgl 15 0 empty empty rts/cts -10 20 1 11 -262144 -258699
-1 0 1;
#X obj 504 487 tgl 15 0 empty empty xon/xoff -14 20 1 11 -262144 -258699
-1 0 1;
#X text 136 401 serial packet format:;
#X text 364 486 handshaking:;
#X text 68 257 flow control inputs:;
#X obj 196 257 tgl 15 0 empty empty dsr 0 20 1 11 -262144 -258699 -1
0 1;
#X obj 223 257 tgl 15 0 empty empty cts 0 20 1 11 -262144 -258699 -1
0 1;
#X obj 599 391 tgl 15 0 empty empty open -6 20 1 11 -262144 -258699
-1 0 1;
#X obj 574 309 print port_list;
#X obj 518 150 print other;
#X obj 140 104 route baud dsr cts parity stop data rtscts xonxoff port
open ports hupcl;
#X obj 559 236 tgl 15 0 empty empty hupcl -6 20 1 11 -262144 -258699
-1 0 1;
#X obj 137 35 inlet;
#X connect 15 0 0 0;
#X connect 15 1 10 0;
#X connect 15 2 11 0;
#X connect 15 3 1 0;
#X connect 15 4 2 0;
#X connect 15 5 3 0;
#X connect 15 6 5 0;
#X connect 15 7 6 0;
#X connect 15 8 4 0;
#X connect 15 9 12 0;
#X connect 15 10 13 0;
#X connect 15 11 16 0;
#X connect 15 12 14 0;
#X connect 17 0 15 0;
#X restore 146 293 pd other-info;
#N canvas 117 434 657 369 conversion-refs 0;
#X obj 62 144 any2bytes;
#X msg 96 60 A;
#X obj 289 172 bytes2any;
#X msg 277 109 77;
#X msg 56 63 S;
#X msg 140 68 C;
#X msg 182 68 M;
#X msg 219 65 m;
#X msg 260 74 L;
#X obj 62 166 print;
#X obj 289 194 print;
#X text 421 52 escape : 92 \; delimiter : 10 \; cr : 13 \;;
#X text 413 131 Setup: S (83) \; Address: A (65) \; Config: C (67)
\; MMG: M (77) \; MPU: m (109) \; LED: L (76) \; battery: b (98) \;
;
#X msg 335 115 98;
#X connect 0 0 9 0;
#X connect 1 0 0 0;
#X connect 2 0 10 0;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 0 0;
#X connect 6 0 0 0;
#X connect 7 0 0 0;
#X connect 8 0 0 0;
#X connect 13 0 2 0;
#X restore 56 52 pd conversion-refs;
#X obj 280 149 *~;
#X obj 280 172 dac~;
#X floatatom 310 99 5 0 0 0 - - -, f 5;
#X obj 310 118 dbtorms;
#X obj 47 249 komport 2 115200;
#N canvas 0 22 591 320 read-buffered-MMG-signal 0;
#X obj 116 260 outlet~;
#X obj 116 209 -~ 1;
#X obj 116 186 *~ 2;
#X obj 117 106 vline~;
#X obj 116 164 /~ 1023;
#X obj 116 126 tabread4~ mmg-signal;
#X text 183 163 << normalize 10-bit range;
#X text 183 194 << scale and offset to normal -1 to 1 signal range
;
#X obj 114 30 inlet;
#X msg 117 72 0 \, 8191 16384;
#X text 218 68 For 500Hz sampling rate \, we'll play back the 8192
sample buffer in 8192ms;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 5 0;
#X connect 4 0 2 0;
#X connect 5 0 4 0;
#X connect 8 0 9 0;
#X connect 9 0 3 0;
#X restore 280 39 pd read-buffered-MMG-signal;
#X obj 223 392 vsl 15 128 0 65536 0 0 empty MPU-1-1 empty 0 -9 0 10
-262144 -1 -1 85 1;
#X obj 243 392 vsl 15 128 0 65536 0 0 empty MPU-1-2 empty 0 -9 0 10
-262144 -1 -1 12029 1;
#X obj 263 392 vsl 15 128 0 65536 0 0 empty MPU-1-3 empty 0 -9 0 10
-262144 -1 -1 3245 1;
#X obj 333 392 vsl 15 128 0 65536 0 0 empty MPU-2-1 empty 0 -9 0 10
-262144 -1 -1 12693 1;
#X obj 353 392 vsl 15 128 0 65536 0 0 empty MPU-2-2 empty 0 -9 0 10
-262144 -1 -1 2 1;
#X obj 373 392 vsl 15 128 0 65536 0 0 empty MPU-2-3 empty 0 -9 0 10
-262144 -1 -1 3 1;
#X obj 453 392 vsl 15 128 0 65536 0 0 empty MPU-3-1 empty 0 -9 0 10
-262144 -1 -1 3671 1;
#X obj 473 392 vsl 15 128 0 65536 0 0 empty MPU-3-2 empty 0 -9 0 10
-262144 -1 -1 3671 1;
#X obj 493 392 vsl 15 128 0 65536 0 0 empty MPU-3-3 empty 0 -9 0 10
-262144 -1 -1 3671 1;
#X text 221 366 Accel;
#X text 331 366 Gyro;
#X text 451 366 Mag;
#X obj 280 13 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#N canvas 0 22 450 278 (subpatch) 0;
#X array mmg-signal 8192 float 0;
#X coords 0 1023 8191 0 400 100 1 0 0;
#X restore 273 236 graph;
#X obj 548 134 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 548 154 s export-file;
#X obj 573 65 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 573 85 s bufread-reset;
#N canvas 710 384 824 552 upsample-filter 0;
#X obj 54 139 inlet~;
#X obj 52 447 outlet~;
#X obj 50 315 *~ 0.125;
#X obj 50 338 rzero~ -1;
#X obj 50 361 rzero~ -1;
#X obj 50 384 rzero~ -1;
#X obj 49 212 rpole~ 0.87467;
#X obj 49 189 *~ 0.12532;
#X obj 49 235 *~ 0.01668;
#X floatatom 168 111 7 0 0 0 - - -, f 7;
#X obj 168 161 / 16;
#X obj 168 136 / 22050;
#X obj 49 258 cpole~ 0.9293 0.10812;
#X obj 49 284 cpole~ 0.9293 -0.10812;
#X obj 168 187 buttercoef3;
#X obj 168 60 loadbang;
#X obj 337 159 block~ 64 1 16;
#X text 328 76 Upsample to 16x and low-pass filter at 250Hz (device's
Nyquist);
#X msg 168 86 250;
#X connect 0 0 7 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 1 0;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X connect 8 0 12 0;
#X connect 9 0 11 0;
#X connect 10 0 14 0;
#X connect 11 0 10 0;
#X connect 12 0 13 0;
#X connect 12 1 13 1;
#X connect 13 0 2 0;
#X connect 14 0 2 1;
#X connect 14 1 8 1;
#X connect 14 2 6 1;
#X connect 14 3 12 2;
#X connect 14 3 13 2;
#X connect 14 4 12 3;
#X connect 14 5 13 3;
#X connect 15 0 18 0;
#X connect 18 0 9 0;
#X restore 280 65 pd upsample-filter;
#X connect 0 0 13 0;
#X connect 4 0 13 0;
#X connect 5 0 0 0;
#X connect 6 0 2 1;
#X connect 9 0 10 0;
#X connect 9 0 10 1;
#X connect 11 0 12 0;
#X connect 12 0 9 1;
#X connect 13 0 2 0;
#X connect 13 1 7 0;
#X connect 14 0 33 0;
#X connect 27 0 14 0;
#X connect 29 0 30 0;
#X connect 31 0 32 0;
#X connect 33 0 9 0;
